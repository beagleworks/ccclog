---
/**
 * Codex 年別ページ
 * getStaticPaths で年一覧を生成し、ChangelogPage で表示
 */
import ChangelogPage from '../../components/ChangelogPage.astro';
import { listChangelogYears } from '../../lib/server/changelog-years';

export function getStaticPaths() {
  // content/codex/ ディレクトリから年を自動検出
  const years = listChangelogYears('codex');

  return years.map((year) => ({
    params: { year },
    props: { year, years },
  }));
}

interface Props {
  year: string;
  years: string[];
}

const { year, years } = Astro.props;

// Codex用のJSONを動的にインポート
const changelogData = await import(`../../data/codex/changelog-${year}.json`);
const { months, generatedAt } = changelogData;
---

<ChangelogPage
  year={year}
  years={years}
  months={months}
  generatedAt={generatedAt}
  product="codex"
/>
