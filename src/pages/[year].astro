---
/**
 * Claude Code 年別ページ
 * getStaticPaths で年一覧を生成し、ChangelogPage で表示
 */
import ChangelogPage from '../components/ChangelogPage.astro';
import { listChangelogYears } from '../lib/server/changelog-years';

export function getStaticPaths() {
  // content/ ディレクトリから年を自動検出
  const years = listChangelogYears('claude-code');

  return years.map((year) => ({
    params: { year },
    props: { year, years },
  }));
}

interface Props {
  year: string;
  years: string[];
}

const { year, years } = Astro.props;

// 動的にJSONをインポート
const changelogData = await import(`../data/changelog-${year}.json`);
const { months, generatedAt } = changelogData;
const searchIndexData = await import(`../data/search/claude-code-${year}.json`);
const searchIndex = searchIndexData.default ?? searchIndexData;
---

<ChangelogPage
  year={year}
  years={years}
  months={months}
  generatedAt={generatedAt}
  searchIndex={searchIndex}
  product="claude-code"
/>
